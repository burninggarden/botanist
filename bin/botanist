#! /usr/bin/env bash

display_usage() {
	echo ""
	echo "Usage: botanist <command>"
	echo ""
	echo "Where <command> is one of:"
	echo "    init    - initialize a new Typescript project in the current directory"
	echo "    version - show the currently installed version of Botanist"
	echo "    upgrade - upgrades Botanist on your system to the latest version"
	echo "    help    - show this menu"
	echo ""
}

raise_error() {
	local error_message="$@"
	echo "${error_message}" 1>&2;
}

init() {
	DIR="$(npm root -g)"
	cp -r "$DIR/@burninggarden/botanist/templates/project/." .
	echo "Initialized new Typescript project in current directory."
	git init
	npm install
}

upgrade() {
	npm update -g @burninggarden/botanist
}

print_version() {
	echo "0.0.11"
}

publish() {
	npm test && npm lint && git push && npm publish
}


argument="$1"

if [[ -z $argument ]] ; then
	display_usage
	exit
fi

case $argument in
	-h|--help|help)
		display_usage
		;;
	-i|--init|init)
		init
		;;
	-v|--version|version)
		print_version
		;;
	-u|--upgrade|upgrade)
		upgrade
		;;
	-p|--publish|publish)
		publish
		;;
	*)
		raise_error "Unknown argument: ${argument}"
		display_usage
		;;
esac
